tosca_definitions_version: yorc_tosca_simple_yaml_1_0

metadata:
  template_name: yorc-types
  template_author: yorc
  template_version: 1.0.0

imports:
  - normative: <normative-types.yml>


artifact_types:
  tosca.artifacts.Implementation.Ansible:
    derived_from: tosca.artifacts.Implementation
    description: This artifact type represents a Ansible playbook type that contains Ansible commands that can be executed.
    mime_type: application/x-yaml
    file_ext: [ yml, yaml ]

  org.alien4cloud.artifacts.AnsiblePlaybook:
    description: "Alien4Cloud Ansible Playbook artifact type"
    derived_from: tosca.artifacts.Implementation
    mime_type: application/zip
    file_ext: [ansible]

data_types:
  yorc.datatypes.ProvisioningCredential:
    derived_from: tosca.datatypes.Credential
    properties:
      # Token is optional if keys are provided
      token:
        type: string
        required: false
        description: The token used as a credential for authorization or access to a networked resource.
      # User is required
      user:
        type: string
        required: true
        description: The user (name or ID) used as a credential for authorization or access to a networked resource.

capability_types:
  yorc.capabilities.Endpoint.ProvisioningAdmin:
    derived_from: tosca.capabilities.Endpoint.Admin
    properties:
      # Adds credentials to the admin endpoint used for provisioning
      credentials:
        type: yorc.datatypes.ProvisioningCredential
        description: Credentials used to provision the resource
        required: false
    # # Not supported by alien
    # attributes:
    #   protocol:
    #     type: string
    #     description: >
    #       The name of the protocol (i.e., the protocol prefix) that the endpoint accepts (any OSI Layer 4-7 protocols)
    #       Examples: http, https, ftp, tcp, udp, etc.
    #     default: ssh
    #   port:
    #     type: tosca.datatypes.network.PortDef
    #     description: The port of the endpoint.
    #     default: 22
    #   credentials:
    #     type: yorc.datatypes.ProvisioningCredential
    #     description: Credentials used to provision the resource
    #     required: false
  yorc.capabilities.Assignable:
    derived_from: tosca.capabilities.Root

relationship_types:
  yorc.relationships.AssignsTo:
    derived_from: tosca.relationships.Root
    description: This type represents an IP address assignment to a Compute node type.
    valid_target_types: [ yorc.capabilities.Assignable ]

node_types:
  yorc.nodes.Compute:
    derived_from: tosca.nodes.Compute
    # specialize our admin endpoint
    capabilities:
      endpoint:
        type: yorc.capabilities.Endpoint.ProvisioningAdmin

  # NOTE: Alien specific
  org.alien4cloud.nodes.Job:
    abstract: true
    derived_from: tosca.nodes.Root
    description: >
      A job is a component that has a run operation.
    interfaces:
      tosca.interfaces.node.lifecycle.Runnable:
        submit:
          description: Submit a job to an engine.
        run:
          description: Monitor a submitted job for completion.
        cancel:
          description: Cancel a submitted job.
          